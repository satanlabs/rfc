<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129b" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
      <meta name="DC.Identifier" content="urn:ietf:rfc:142" />
      <meta name="DC.Relation.Replaces" content=""/><meta name="DC.Creator" content="C. Kline"><meta name="DC.Creator" content="J. Wong"><meta name="DC.Date.Issued" content="May, 1971"/>
       <meta name="DC.Title" content=" Time-Out Mechanism in the Host-Host Protocol "/>
       <title>RFC 142:  Time-Out Mechanism in the Host-Host Protocol </title>    
        

        <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->    <script type="text/javascript"><!--
    function addHeaderTags() {
        var spans = document.getElementsByTagName("span");
        for (var i=0; i < spans.length; i++) {
            var elem = spans[i];
            if (elem) {
                var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";               
                }
            }
        }
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script><span class="pre noprint docinfo">[<a href="https://www.rfc-editor.org" title="RFC Editor">RFC Home</a>] [<a href=/rfc/rfc142.txt>TEXT</a>|<a href=/rfc/pdfrfc/rfc142.txt.pdf>PDF</a>|<a href=/rfc/rfc142.html>HTML</a>] [<a href='https://datatracker.ietf.org/doc/rfc142' title='IETF Datatracker information for this document'>Tracker</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=142&submit=rfc" title="IPR disclosures related to this document">IPR</a>]                              </span><br/><span class="pre noprint docinfo">                                                                        </span><br /><span class="pre noprint docinfo">                                                                 UNKNOWN</span><br /><span class="pre noprint docinfo">                                                                        </span><pre>Network Working Group                            Charley Kline
Request for Comments #142                        Johnny Wong
NIC #6727                                        UCLA (NMC)
Categories: C.1, C.2, C.3, C.5                   3 May 71
Updates: none
Obsoletes: none


              <span class="h1">Time-out Mechanism in the Host-Host Protocol</span>

On sending a message to a foreign site, the following situations can
occur:

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>. Destination IMP down - Type 7 message is returned</span>

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>. Destination IMP up but destination IMP-HOST interface is</span>
<span class="h2">   down - Type 7 message is returned.</span>

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>. Destination IMP and IMP-HOST interface up, but IMP-HOST inter-</span>
<span class="h2">   face is not taking messages - Type 9 message is returned after</span>
   IMP time-out (ask BBN for time).

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>. Destination IMP and IMP-HOST interface up and IMP-HOST inter-</span>
<span class="h2">   face is taking messages - Type 5 (rfnm) message is returned.</span>

A suggestion for handling type 7 and type 9 messages has been made in
NWG/RFC #117.  In this document we would like to discuss in detail the
problem: what should happen to the HOST-HOST protocol on receiving a
rfnm?

When a NCP sends out a STR or RTS control command on a pair of sockets
and gets a rfnm back, this pair of sockets will be in a wait-match
state.  Everything is fine if a matching RTS or STR, or CLS is
returned after a reasonable amount of delay.  Trouble will arise when
nothing is returned after a long time.

This can happen if the NCP is not running at all but its host is
taking in messages (e.g. UCLA's host will receive messages even if the
NCP is not running), or if the NCP is running very slowly.  The same
problem exists on sending out a CLS control command and a matching CLS
is never returned.  The trouble is that resources are tied up, e.g.
sockets, links and table space in the NCP; and one would like to
release these resources.  In our implementation, when a user does a
CLOSE, we can't release the sockets until the matching CLS is
returned.  This protects us from getting confused if a seconds request
is made for the same pair of sockets.  This problem can be solved by
including a time-out mechanism in the Host-Host protocol.  This
operates as follows:



<span class="grey">                                                                [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey">ne 5</span>
a.  On sending out a STR or RTS and if you do not get back a match-
    ing RTS or STR, or a CLS in T time units a CLS will be sent.
    After sending the time-out CLS race condition can be avoided
    by ignoring the matching RTS or STR that arrives before the
    matching CLS.

b.  On sending out a CLS (any kind, including the time-out CLS),
    and if you do not get back a matching CLS in T time units, the
    matching CLS is assumed to have returned.  However, if a RTS or
    STR is sent on the same pair of sockets anytime after the time
    out and before a CLS is returned, and then we receive the CLS,
    there is no way to determine whether this returning CLS is for
    matching the previous CLS or for refusing the RTS or STR.  (See
    the figure for detail).  So far we could not solve this race
    condition except by assigning sequence number to connection
    throughout the Network which we don't think is a good solution
    at all.  Hence, we would like to bring the attention of the
    Host-Host Protocol Glitch Cleaning Committe to this problem.
    The time limit T should be a Network Standard and its value should
    be decided also.

       Reason                                Our NCP
       ------                                -------

    1. User requests connection              1. RTS -&gt;

    2. User gets tired requests CLS
       (or NCP timeout)                      2. CLS -&gt;

    3. No matching CLS returned in
       T time units                          3. CLS assumed returned
                                                free socket and other
                                                resources

    4. User requests another connection
       over same socket pair                 4. RTS -&gt;

    5. CLS received                          ?? does it belong to
                                             2 or 4?

                                   Figure

         [ This RFC was put into machine readable form for entry ]
            [ into the online RFC archives by Gert Doering 4/97]






                                                                [Page 2]
</pre>
