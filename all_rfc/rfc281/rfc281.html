<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129b" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
      <meta name="DC.Identifier" content="urn:ietf:rfc:281" />
      <meta name="DC.Relation.Replaces" content=""/><meta name="DC.Creator" content="A.M. McKenzie"><meta name="DC.Date.Issued" content="December, 1971"/>
       <meta name="DC.Title" content=" Suggested addition to File Transfer Protocol "/>
       <title>RFC 281:  Suggested addition to File Transfer Protocol </title>    
        

        <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->    <script type="text/javascript"><!--
    function addHeaderTags() {
        var spans = document.getElementsByTagName("span");
        for (var i=0; i < spans.length; i++) {
            var elem = spans[i];
            if (elem) {
                var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";               
                }
            }
        }
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script><span class="pre noprint docinfo">[<a href="https://www.rfc-editor.org" title="RFC Editor">RFC Home</a>] [<a href=/rfc/rfc281.txt>TEXT</a>|<a href=/rfc/pdfrfc/rfc281.txt.pdf>PDF</a>|<a href=/rfc/rfc281.html>HTML</a>] [<a href='https://datatracker.ietf.org/doc/rfc281' title='IETF Datatracker information for this document'>Tracker</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=281&submit=rfc" title="IPR disclosures related to this document">IPR</a>]                              </span><br/><span class="pre noprint docinfo">                                                                        </span><br /><span class="pre noprint docinfo">                                                                 UNKNOWN</span><br /><span class="pre noprint docinfo">                                                                        </span><pre>Network Working Group                                        A. McKenzie
Request for Comment: 281                                             BBN
NIC: 8163                                                8 December 1971
Category: D.7
Reference: RFC #264, #265


             A suggested Addition to File Transfer Protocol


On November 16, an informal meeting was held at UCLA to discuss
prospects for a network standard Remote Job Service (RJS) protocol.  In
attendance were representatives of UCLA-CCN and UCSB, the
network's only current RJS sites, as well as UCLA-NMC and the BBN
network project.  A report on that discussion will be published as an
RFC shortly and will not be discussed here.  In thinking about the use
of the proposed File Transfer Protocol (FTP) (RFC #265) for RJS,
however, we came to the conclusion that a "restart" procedure might be
an extremely useful addition to the FTP.

Many, perhaps most, of the individuals involved in protocol design thus
far are oriented toward the use of short date transmissions over the
network the transmission lengths that have been considered "typical" are
a few characters, a print line, or perhaps as much as a page of text.
The experience of the current RJS sites, however, is that single files
are commonly much longer, for example a line-printer output file of 400
pages would not seem unusual to these sites.  Further, one might
reasonably predict that network use of Remote Job Services will be
preselected with a tendency toward large jobs (although large jobs do
not necessarily imply large I/O files) and that the addition of other
batch service sites (ILLIAC, UCSD) will increase the number of long-file
transfers.  In light of this kind of experience/prediction, it would
seem that the FTP should include (perhaps as an option which
interactive-user oriented systems could ignore) a method of "restarting"
a long file transfer if some element in the transmission path fails
after a large volume of data has been transferred.

The critical element in a "restart" procedure is the ability to arrange
agreement between both ends of the transmission path as to where,
exactly, the retransmission should begin.  There are two potential
candidates for marking possible restart locations already built into the
proposed Data Transfer Protocol (RFC #264) which underlies the FTP;
these are:

      a) The "information separators" (transaction type B4) which are
      available in both "transparent block" transfers and "descriptor
      and counts" transfers, and




<span class="grey">McKenzie                                                        [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="./rfc281">RFC 281</a>      A Suggested Addition to File Transfer ProtocolDecember 1971</span>


      b) The "sequence numbers" which can be used with the "descriptor
      and counts" transfer mode.

















































<span class="grey">McKenzie                                                        [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="./rfc281">RFC 281</a>      A Suggested Addition to File Transfer ProtocolDecember 1971</span>


   After some discussion, we seemed to agree that the "information
   separators" (as they would be used in "transparent block" transfer
   mode, i.e., without "sequence numbers") were unlikely to serve as
   UNAMBIGUOUS restart location marker, and therefore we suggest the use
   of "sequence numbers" as markers.  We were aware of the fact that
   this choice might exclude TIPs and other Hosts which do not use
   sequence numbering from the type of recovery under discussion; we
   believe, however, that our suggestion eliminates at least some of
   this problem.

   Imagine that some site, which we will call the "user site" or "user",
   has initiated a connection from its own file transfer process to a
   file transfer process at some other site, which we will call the
   "server site" or "server".  After the appropriate exchanges of
   information, a file transfer (using the File Transfer Protocol)
   begins over the path between these two sites.  After some information
   is transferred, the path between the user and server is broken.  At
   some later time the user initiates a new connection between the file
   transfer processes at user and server, establishes relevant access
   privileges, and wishes to resume the transmission which was in
   progress when the path was broken.  First we describe four new op-
   codes for the File Transfer Protocol:

   Hex        Operation
   ---        ---------
   10         Append at sequence number

              This command is essentially the same as any of the "Store"
              or "Append..." commands except that a 16-bit sequence
              number immediately follows the op-code (before the
              pathname).

   11         Retrieve at sequence number

              This is the same as the "Retrieve"command except that a
              16-bit sequence number immediately follows the op-code
              (before the pathname).

   12         Resume Retrieve

              To be used when the user wishes the server to choose the
              sequence number; in other respects this is identical to
              the "Retrieve" command.








<span class="grey">McKenzie                                                        [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="./rfc281">RFC 281</a>      A Suggested Addition to File Transfer ProtocolDecember 1971</span>


   13         Use the sequence number

              This command contains only the op-code and a 16-bit
              sequence number.  It is intended as a denial of the
              ability to locate the sequence number given in an "Append
              at sequence number" or "Retrieve at sequence number"
              command and, simultaneously, to suggest another number
              which can be located.

   There are several possible cases which are shown below.  The user
   site is always presumed to be the site at the left of the page.








































<span class="grey">McKenzie                                                        [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="./rfc281">RFC 281</a>      A Suggested Addition to File Transfer ProtocolDecember 1971</span>


   A.   User site sending at time path is broken:
       /
      /   Append at sequence number
     |    -------------------------------------------&gt;
     |    Acknowledge
     |    &lt;------------------------------------------
     |    Data
     |    -------------------------------------------&gt;
     |
      \   The server site agrees to resume at the user-chosen point.
       \  The first data transaction is numbered with the chosen
        \ sequence number.

       /  Append at sequence number
      /   -------------------------------------------&gt;
     |    Unsuccessful Terminate
     |    &lt;-------------------------------------------
     |
      \   The server site will never permit restart for some reason
       \  (seq. #s were ignored or not used initially, seq #s were not
        \ stored with the file, the file was lost when the path was
         \broken, etc.)

       /  Append at sequence number
      /   -------------------------------------------&gt;
     |    Use this sequence number
     |    &lt;-------------------------------------------
     |       /       Data
     |      /        ---------------------------------&gt;
     |      \        The user site agrees to use the server-chosen number
     |       \       and the first data transaction is numbered with the
     |        \      chosen number.
     |
     |                       or
     |
     |         /      Unsuccessful Terminate
      \       /       -------------------------------&gt;
       \      \       The user site cannot restart at this number for
        \      \     some reason.












<span class="grey">McKenzie                                                        [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="./rfc281">RFC 281</a>      A Suggested Addition to File Transfer ProtocolDecember 1971</span>


   B.  User site receiving at time path is broken, and the user site
   does not particularly care about the exact sequence number (for
   example, if the user site is sending the file to a printer, some
   duplicate pages are probably acceptable and the user site would
   probably not want to remember sequence numbers).

               /  Resume Retrieve
              /   ------------------------------------&gt;
             |    Data
             |    &lt;------------------------------------
             |    The server picks some point and begins transmission at
             |    that point.  If sequence numbers were used during the
             |    original transmission, then the first transaction of
             |    this transmission must exactly match (including
             |    sequence number) some transaction of the original
              \   transmission.

               /  Resume Retrieve
              /   ------------------------------------&gt;
             |    Unsuccessful Terminate
              \   &lt;------------------------------------
               \  The server site is unable or unwilling to restart the
                \ transmission.




























<span class="grey">McKenzie                                                        [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="./rfc281">RFC 281</a>      A Suggested Addition to File Transfer ProtocolDecember 1971</span>


   C.  User site receiving at time path is broken, and does care about
   the value of the sequence number.

               /  Retrieve at sequence number
              /   ----------------------------------------&gt;
             |    Data
             |    &lt;----------------------------------------
              \   The server agrees to resume at the user-chosen
               \  point. The first data transaction is numbered
                \ with the chosen sequence number.

               /  Retrieve at sequence number
              /   ----------------------------------------&gt;
             |    Unsuccessful Terminate
             |    &lt;----------------------------------------
             |
             |    The server site will never permit restart for some
             |    reason.
             |    Retrieve at sequence number
             |    ----------------------------------------&gt;
             |    Use this sequence number
             |    &lt;-----------------------------------------
             |            /    Acknowledge
             |           /     ----------------------------&gt;
             |          |      Data
             |          |      &lt;----------------------------
             |           \     The user site agrees to use the
             |            \    server-chosen number.  The first data
             |             \   transaction is numbered with the chosen
             |              \  number.
             |
             |                               or
             |
             |             /   Unsuccessful Terminate
             |            /    -----------------------------&gt;
             |           |
              \           \    The server cannot use the user-chosen
               \           \   number and the user cannot use the
                \           \  server-chosen number. Therefore the attempt
                 \           \ to restart must be abandoned.











<span class="grey">McKenzie                                                        [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="./rfc281">RFC 281</a>      A Suggested Addition to File Transfer ProtocolDecember 1971</span>


   Some sites (e.g., UCLA-CCN) have agreed (in principle, at least) to
   implement these commands and, more important, to store sequence
   numbers (with files being transferred) on a non-volatile storage
   medium so that restarts may be effected.  This will be done, of
   course, only if this, or some similar, proposal is accepted by the
   NWG as part of the File Transfer Protocol.  We hope interested
   parties will communicate comments or counter-proposals to the FTP
   committee and/or publish their ideas in the RFC series.

   AAM/jm











          [This RFC was put into machine readable form for entry]
      [into the online RFC archives by Kelly Tardif, Viaginie 10/99]




























McKenzie                                                        [Page 8]
</pre>
