<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129b" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
      <meta name="DC.Identifier" content="urn:ietf:rfc:5803" />
      <meta name="DC.Relation.Replaces" content=""/><meta name="DC.Creator" content="A. Melnikov"><meta name="DC.Date.Issued" content="July, 2010"/>
       <meta name="DC.Title" content="Lightweight Directory Access Protocol (LDAP) Schema for Storing Salted Challenge Response Authentication Mechanism (SCRAM) Secrets"/>
       <title>RFC 5803: Lightweight Directory Access Protocol (LDAP) Schema for Storing Salted Challenge Response Authentication Mechanism (SCRAM) Secrets</title>    
        

        <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->    <script type="text/javascript"><!--
    function addHeaderTags() {
        var spans = document.getElementsByTagName("span");
        for (var i=0; i < spans.length; i++) {
            var elem = spans[i];
            if (elem) {
                var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";               
                }
            }
        }
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script><span class="pre noprint docinfo">[<a href="https://www.rfc-editor.org" title="RFC Editor">RFC Home</a>] [<a href=/rfc/rfc5803.txt>TEXT</a>|<a href=/rfc/pdfrfc/rfc5803.txt.pdf>PDF</a>|<a href=/rfc/rfc5803.html>HTML</a>] [<a href='https://datatracker.ietf.org/doc/rfc5803' title='IETF Datatracker information for this document'>Tracker</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=5803&submit=rfc" title="IPR disclosures related to this document">IPR</a>] [<a class="boldtext" href="/errata/rfc5803" target="_blank">Errata</a>]                     </span><br/><span class="pre noprint docinfo">                                                                        </span><br /><span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br /><span class="pre noprint docinfo">                                                            <span style='color: #C00;'>Errata Exist</span></span><pre>Internet Engineering Task Force (IETF)                       A. Melnikov
Request for Comments: 5803                                 Isode Limited
Category: Informational                                        July 2010
ISSN: 2070-1721


 <span class="h1">Lightweight Directory Access Protocol (LDAP) Schema for Storing Salted</span>
      <span class="h1">Challenge Response Authentication Mechanism (SCRAM) Secrets</span>

Abstract

   This memo describes how the "authPassword" Lightweight Directory
   Access Protocol (LDAP) attribute can be used for storing secrets used
   by the Salted Challenge Response Authentication Message (SCRAM)
   mechanism in the Simple Authentication and Security Layer (SASL)
   framework.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="./rfc5741#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc5803">http://www.rfc-editor.org/info/rfc5803</a>.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.




<span class="grey">Melnikov                      Informational                     [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="./rfc5803">RFC 5803</a>          LDAP Schema for Storing SCRAM Secrets        July 2010</span>


Table of Contents

   <a href="#section-1">1</a>. Overview ........................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. Conventions Used in This Document ...............................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Security Considerations .........................................<a href="#page-3">3</a>
   <a href="#section-4">4</a>. Acknowledgements ................................................<a href="#page-4">4</a>
   <a href="#section-5">5</a>. Normative References ............................................<a href="#page-4">4</a>

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Overview</span>

   This document describes how the authPassword LDAP attribute
   [<a href="#ref-AUTHPASS" title="&quot;LDAP Authentication Password Schema&quot;">AUTHPASS</a>] can be used for storing secrets used by [<a href="#ref-SCRAM" title="&quot;Salted Challenge Response Authentication Message (SCRAM) SASL Mechanisms&quot;">SCRAM</a>] Simple
   Authentication and Security Layer [<a href="./rfc4422" title="&quot;Simple Authentication and Security Layer (SASL)&quot;">RFC4422</a>] Mechanisms.

      The "scheme" part of the authPassword attribute is the SCRAM
      mechanism name (always without the "-PLUS" suffix), e.g., "SCRAM-
      SHA-1".  See [<a href="#ref-SCRAM" title="&quot;Salted Challenge Response Authentication Message (SCRAM) SASL Mechanisms&quot;">SCRAM</a>] for the exact syntax of SCRAM mechanism
      names.

      The "authInfo" part of the authPassword attribute is the iteration
      count (iter-count in the ABNF below), followed by ":" and base64-
      encoded [<a href="#ref-BASE64" title="&quot;The Base16, Base32, and Base64 Data Encodings&quot;">BASE64</a>] salt.

      The "authValue" part of the authPassword attribute is the base64-
      encoded [<a href="#ref-BASE64" title="&quot;The Base16, Base32, and Base64 Data Encodings&quot;">BASE64</a>] StoredKey [<a href="#ref-SCRAM" title="&quot;Salted Challenge Response Authentication Message (SCRAM) SASL Mechanisms&quot;">SCRAM</a>], followed by ":" and base64-
      encoded [<a href="#ref-BASE64" title="&quot;The Base16, Base32, and Base64 Data Encodings&quot;">BASE64</a>] ServerKey [<a href="#ref-SCRAM" title="&quot;Salted Challenge Response Authentication Message (SCRAM) SASL Mechanisms&quot;">SCRAM</a>].

   Syntax of the attribute can be expressed using ABNF [<a href="./rfc5234" title="&quot;Augmented BNF for Syntax Specifications: ABNF&quot;">RFC5234</a>].  Non-
   terminal references in the following ABNF are defined in either
   [<a href="#ref-AUTHPASS" title="&quot;LDAP Authentication Password Schema&quot;">AUTHPASS</a>], [<a href="./rfc4422" title="&quot;Simple Authentication and Security Layer (SASL)&quot;">RFC4422</a>], or [<a href="./rfc5234" title="&quot;Augmented BNF for Syntax Specifications: ABNF&quot;">RFC5234</a>].

       scram-mech     = "SCRAM-SHA-1" / scram-mech-ext
                      ; Complies with ABNF for &lt;scheme&gt;
                      ; defined in [<a href="#ref-AUTHPASS" title="&quot;LDAP Authentication Password Schema&quot;">AUTHPASS</a>].

       scram-authInfo = iter-count ":" salt
                      ; Complies with ABNF for &lt;authInfo&gt;
                      ; defined in [<a href="#ref-AUTHPASS" title="&quot;LDAP Authentication Password Schema&quot;">AUTHPASS</a>].

       scram-authValue = stored-key ":" server-key
                      ; Complies with ABNF for &lt;authValue&gt;
                      ; defined in [<a href="#ref-AUTHPASS" title="&quot;LDAP Authentication Password Schema&quot;">AUTHPASS</a>].

       iter-count   = %x31-39 *DIGIT
                      ; SCRAM iteration count.
                      ; A positive number without leading zeros.

       salt         = &lt;base64-encoded value&gt;



<span class="grey">Melnikov                      Informational                     [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="./rfc5803">RFC 5803</a>          LDAP Schema for Storing SCRAM Secrets        July 2010</span>


       stored-key   = &lt;base64-encoded value&gt;
                      ; See definition in [<a href="#ref-SCRAM" title="&quot;Salted Challenge Response Authentication Message (SCRAM) SASL Mechanisms&quot;">SCRAM</a>].

       server-key   = &lt;base64-encoded value&gt;
                      ; See definition in [<a href="#ref-SCRAM" title="&quot;Salted Challenge Response Authentication Message (SCRAM) SASL Mechanisms&quot;">SCRAM</a>].

       scram-mech-ext = "SCRAM-" 1*9mech-char
                      ; Other SCRAM mechanisms registered
                      ; in the IANA registry for SASL
                      ; mechanism names.

       mech-char    = &lt;Defined in <a href="./rfc4422">RFC 4422</a>&gt;

   Note that the authPassword attribute is multivalued.  For example, it
   may contain multiple SCRAM hashes for different hashing algorithms.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="./rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Security Considerations</span>

   This document defines how the authPassword attribute can be used to
   store SCRAM secrets.  Therefore, security considerations relevant to
   [<a href="#ref-SCRAM" title="&quot;Salted Challenge Response Authentication Message (SCRAM) SASL Mechanisms&quot;">SCRAM</a>] and hash functions used with it are also relevant to this
   document.

   General security considerations related to the authPassword attribute
   (as specified in [<a href="#ref-AUTHPASS" title="&quot;LDAP Authentication Password Schema&quot;">AUTHPASS</a>]) also apply to the use of authPassword as
   specified in this document.  In particular, the values of
   authPassword SHOULD be protected as if they were cleartext passwords.
   A read operation on this attribute that is not protected by a privacy
   layer (such as IPsec or TLS) can expose this attribute to an attacker
   who a) would be able to use the intercepted value to impersonate the
   user to all servers providing SCRAM access using the same hash
   function, password, iteration count, and salt or b) would be able to
   perform an offline dictionary or brute-force attack in order to
   recover the user's password.

   Servers MUST validate the format of the authPassword attribute before
   using it for performing a SCRAM authentication exchange.  It is
   possible that an attacker compromised the LDAP server or got access
   to the entry containing the attribute in order to exploit a
   vulnerability in the subsystem performing the SCRAM authentication





<span class="grey">Melnikov                      Informational                     [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="./rfc5803">RFC 5803</a>          LDAP Schema for Storing SCRAM Secrets        July 2010</span>


   exchange.  Big iteration counts and invalid base64 encoding are two
   possible (but not the only) exploits in the format specified in the
   document.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  Acknowledgements</span>

   The author gratefully acknowledges the feedback provided by Chris
   Newman, Kurt Zeilenga, Chris Lonvick, Peter Saint-Andre, Barry Leiba,
   and Chris Ridd.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Normative References</span>

   [<a id="ref-AUTHPASS">AUTHPASS</a>]  Zeilenga, K., "LDAP Authentication Password Schema",
               <a href="./rfc3112">RFC 3112</a>, May 2001.

   [<a id="ref-BASE64">BASE64</a>]    Josefsson, S., "The Base16, Base32, and Base64 Data
               Encodings", <a href="./rfc4648">RFC 4648</a>, October 2006.

   [<a id="ref-RFC2119">RFC2119</a>]   Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-RFC4422">RFC4422</a>]   Melnikov, A. and K. Zeilenga, "Simple Authentication and
               Security Layer (SASL)", <a href="./rfc4422">RFC 4422</a>, June 2006.

   [<a id="ref-RFC5234">RFC5234</a>]   Crocker, D. and P. Overell, "Augmented BNF for Syntax
               Specifications: ABNF", STD 68, <a href="./rfc5234">RFC 5234</a>, January 2008.

   [<a id="ref-SCRAM">SCRAM</a>]     Menon-Sen, A., Newman, C., Melnikov, A., and N. Williams,
               "Salted Challenge Response Authentication Message (SCRAM)
               SASL Mechanisms", <a href="./rfc5802">RFC 5802</a>, July 2010.

Author's Address

   Alexey Melnikov
   Isode Limited
   5 Castle Business Village
   36 Station Road
   Hampton, Middlesex  TW12 2BX
   UK

   EMail: alexey.melnikov@isode.com
   URI:   <a href="http://www.melnikov.ca/">http://www.melnikov.ca/</a>









Melnikov                      Informational                     [Page 4]
</pre>
